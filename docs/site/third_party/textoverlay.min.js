// https://github.com/yuku-t/textoverlay/blob/v0.3.0/dist/textoverlay.es5.min.js
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Textoverlay=t():e.Textoverlay=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){Object.keys(t).forEach(function(r){e.style.setProperty(r,t[r])})}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),i={backdrop:{"box-sizing":"border-box",position:"absolute",margin:"0px"},overlay:{"box-sizing":"border-box","border-color":"transparent","border-style":"solid",color:"transparent",position:"absolute","white-space":"pre-wrap","word-wrap":"break-word",overflow:"hidden",margin:"0px"},textarea:{background:"transparent"}},n={background:["background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size"],overlay:["font-family","font-size","font-weight","line-height","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width"]},s=function(){function e(t,a){var s=this;if(r(this,e),this.overlayPositioner=null,null===t.parentElement)throw new Error("textarea must be in the DOM tree");this.textarea=t,this.textareaStyle=window.getComputedStyle(t),this.backdrop=document.createElement("div"),this.backdrop.className="textoverlay-backdrop",o(this.backdrop,i.backdrop),this.copyTextareaStyle(this.backdrop,n.background),this.textarea.parentElement.insertBefore(this.backdrop,this.textarea),this.overlay=document.createElement("div"),this.overlay.className="textoverlay",o(this.overlay,i.overlay),this.copyTextareaStyle(this.overlay,n.overlay),this.textarea.parentElement.insertBefore(this.overlay,this.textarea),this.syncStyles(),this.textareaStyleWas={},Object.keys(i.textarea).forEach(function(e){s.textareaStyleWas[e]=s.textarea.style.getPropertyValue(e)}),o(this.textarea,i.textarea),this.strategies=a,this.textarea.addEventListener("input",function(){s.handleInput()}),this.textarea.addEventListener("scroll",function(){s.handleScroll()}),this.observer=new MutationObserver(function(){s.syncStyles()}),this.observer.observe(this.textarea,{attributes:!0,attributeFilter:["style"]}),this.resizeListener=function(){s.syncStyles()},window.addEventListener("resize",this.resizeListener),this.render()}return a(e,[{key:"destroy",value:function(){window.removeEventListener("resize",this.resizeListener),this.textarea.removeEventListener("input",this.handleInput),this.textarea.removeEventListener("scroll",this.handleScroll),this.observer.disconnect(),this.overlay.remove(),this.backdrop.remove(),o(this.textarea,this.textareaStyleWas)}},{key:"render",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.updateOverlayNodes(),this.syncStyles()}},{key:"updateOverlayNodes",value:function(){for(var e=this;this.overlay.firstChild;)this.overlay.removeChild(this.overlay.firstChild);this.overlayPositioner=document.createElement("div"),this.overlayPositioner.className="textoverlay-positioner",this.overlayPositioner.style.display="block",this.overlay.appendChild(this.overlayPositioner),this.computeOverlayNodes().forEach(function(t){e.overlay.appendChild(t)})}},{key:"syncStyles",value:function(){var e=this.textarea.offsetTop,t=this.textarea.offsetLeft,r=this.textarea.offsetHeight,o=this.textarea.clientWidth+parseInt(this.textareaStyle.borderLeftWidth||"0",10)+parseInt(this.textareaStyle.borderRightWidth||"0",10),a=this.textarea.scrollTop,i=null!==this.textareaStyle.zIndex&&"auto"!==this.textareaStyle.zIndex?+this.textareaStyle.zIndex:0;this.backdrop.style.zIndex=""+(i-2),this.overlay.style.zIndex=""+(i-1),this.backdrop.style.left=this.overlay.style.left=t+"px",this.backdrop.style.top=this.overlay.style.top=e+"px",this.backdrop.style.height=this.overlay.style.height=r+"px",this.backdrop.style.width=this.overlay.style.width=o+"px",this.setOverlayScroll(a)}},{key:"setOverlayScroll",value:function(e){null!==this.overlayPositioner&&(this.overlayPositioner.style.marginTop="-"+e+"px")}},{key:"computeOverlayNodes",value:function(){return this.strategies.reduce(function(e,t){var r=document.createElement("span");return o(r,t.css),Array.prototype.concat.apply([],e.map(function(e){if(e.nodeType!==Node.TEXT_NODE)return e;for(var o=e.textContent||"",a=[];;){var i=t.match.lastIndex,n=t.match.exec(o);if(!n){a.push(document.createTextNode(o.slice(i)));break}var s=n[0];a.push(document.createTextNode(o.slice(i,t.match.lastIndex-s.length)));var l=r.cloneNode();l.textContent=s,a.push(l)}return a}))},[document.createTextNode(this.textarea.value)])}},{key:"handleInput",value:function(){this.render()}},{key:"handleScroll",value:function(){this.setOverlayScroll(this.textarea.scrollTop)}},{key:"copyTextareaStyle",value:function(e,t){var r=this;t.forEach(function(t){e.style.setProperty(t,r.textareaStyle.getPropertyValue(t))})}}]),e}();t.default=s}]).default});
